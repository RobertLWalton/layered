// Layered Languages Parser Operator Command Test Data
//
// File:	ll_parser_oper_command_test.in
// Author:	Bob Walton (walton@acm.org)
// Date:	Tue Feb  7 01:24:38 EST 2017
//
// The authors have placed this data in the public
// domain; they make no warranty and accept no liability
// for this data.

parser:
    print selector ""
    print pass
    print context ""
    define pass operator [code, math] after top
    print pass
    trace [+ parser commands, + warnings ]
    trace [+ subexpression elements,
           + subexpression lines ]
    print selector ""
    print operator ""

// Test define and undefine
//
parser:
    begin block
parser test:
    ( x / y ^ z w )
parser:
    define operator "/" [code, math] infix
        with binary reformatter with precedence -100
    print operator "/"
    define operator "^" [code, math] infix
        with binary reformatter with precedence +100
parser test:
    ( x / y ^ z w )
parser:
    print operator ""
    undefine operator "/" [code, math] infix
        with precedence -100
    print operator "/"
parser test:
    ( x / y ^ z w )
parser:
    end block
    print operator ""
parser test:
    ( x / y ^ z w )

// Test erroneous defines and undefines
//
parser:
    define operator "+" [code, math] infix
        with binary reformatter
    define operator "+" [code, math]
        with precedence 3000
        with binary reformatter
    define operator "+" [code, math] infix nofix
        with precedence 3000
        with binary reformatter
    define operator "+" [code, math] nofix
        with precedence 3000
        with right associative reformatter
    define operator "+" [code, math] nofix
        with precedence 3000
        with none such reformatter
    undefine operator "+" [code, math] infix
    undefine operator "+" [code, math] infix
        with precedence 3000
        with binary reformatter
    undefine operator "+" [code, math]
        with precedence 3000
    print operator ""

// Operators are introduced lowest precedence first

parser:
    define operator "=" [code, math] infix
        with precedence 1000
        with right associative reformatter
    define operator "+=" [code, math] infix
        with precedence 1000
        with right associative reformatter
    define operator "-=" [code, math] infix
        with precedence 1000
        with right associative reformatter
    define operator "*=" [code, math] infix
        with precedence 1000
        with right associative reformatter
    define operator "/=" [code, math] infix
        with precedence 1000
        with right associative reformatter
parser test:
    (x = y += z w *= p q r = t v)

parser:
    define operator "," [code, math] nofix
        with precedence 2000
        with separator reformatter ( "," )
parser test:
    (x, y1, z w,, 3,)

parser:
    define operator "BUT NOT" [code, math] infix
        with precedence 3000
        with binary reformatter
    define operator "AND" [code, math] infix
        with precedence 3100
        with infix reformatter
    define operator "OR" [code, math] infix
        with precedence 3100
        with infix reformatter
    define operator "NOT" [code, math] nofix
        with precedence 3100
        with unary reformatter
parser test:
    (x OR y BUT NOT z AND w)
    (x OR y BUT NOT z AND w OR p)
    (NOT x y)
    (x NOT y)
    (NOT x AND y)
    (x AND NOT y)
    (x AND AND y)
    (NOT NOT x y)
    (NOT NOT)

parser:
    define operator "==" [code, math] infix
        with precedence 4000
        with infix and reformatter ( "AND" )
    define operator "/=" [code, math] infix
        with precedence 4000
        with infix and reformatter ( "AND" )
    define operator "!=" [code, math] infix
        with precedence 4000
        with infix and reformatter ( "AND" )
    define operator "<" [code, math] infix
        with precedence 4000
        with infix and reformatter ( "AND" )
    define operator "<=" [code, math] infix
        with precedence 4000
        with infix and reformatter ( "AND" )
    define operator "=<" [code, math] infix
        with precedence 4000
        with infix and reformatter ( "AND" )
    define operator ">" [code, math] infix
        with precedence 4000
        with infix and reformatter ( "AND" )
    define operator ">=" [code, math] infix
        with precedence 4000
        with infix and reformatter ( "AND" )
    define operator "=>" [code, math] infix
        with precedence 4000
        with infix and reformatter ( "AND" )
parser test:
    ( x < y <= z > w != p q =< u v )

parser:
    define operator "+" [code, math] infix
        with precedence 5000
        with sum reformatter ( "+", "-" )
    define operator "-" [code, math] infix
        with precedence 5000
        with sum reformatter ( "+", "-" )
parser test:
    ( x + y - z + w - v - u )
    ( - x + y - z )
    ( x < y + 5 <= z )

parser:
    define operator "/" [code, math] infix
        with precedence 5100
        with binary reformatter
    define operator "*" [code, math] infix
        with precedence 5200
        with infix reformatter
    define operator "^" [code, math] infix
        with precedence 5300
        with binary reformatter
parser test:
    ( x * y / z q * m p )
    ( x / y / z )
    ( x ^ 2 * y ^ 2 / y * z )

parser:
    define operator "+" [code, math] prefix
        with precedence 10000
    define operator "-" [code, math] prefix
        with precedence 10000
    define operator "@" [code, math] prefix
        with precedence 10000
parser test:
    ( - x + y - z )
    ( p * - x + y - z )
    ( @ x + y - @ z )
    ( + - + - x y )

parser:
    define operator "++" [code, math] postfix
        with precedence 10001
    define operator "--" [code, math] postfix
        with precedence 10001
parser test:
    ( x ++ + y - z -- )
    ( x y ++ -- ++ -- )

parser:
    define operator "<--" [code] nofix
        with precedence 0
        with declare reformatter
    define operator bracket "{{" ... "}}" [code] afix
        with precedence 0
    define operator indentation mark ":" [code] afix
        with precedence 0
parser test:
    ( foo bar <-- boo bat {{ fee fie fo fum }} )
    ( foo bar <-- {{ fee fie fo fum }} )
    ( <-- boo bat {{ fee fie fo fum }} )
    ( foo bar <-- )
    foo bar <-- boo bat:
    	fee fie fo fum
	he ha ho hum

parser:
    print operator ""

// Temporary tests
